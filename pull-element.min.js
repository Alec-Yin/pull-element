!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.PullElement=i()}(this,function(){"use strict";function t(t){for(var i=arguments,o=i.length,n=1;n<o;n++){var e=i[n];for(var r in e)t[r]=e[r]}return t}function i(t){return"number"==typeof t&&!isNaN(t)}function o(t){return"[object Object]"===Object.prototype.toString.call(t)}function n(t){return"function"==typeof t}function e(i){var o=i.scrollTop,n=i.scrollLeft,e=i.offsetWidth,r=i.offsetHeight,l=i.scrollWidth,h=i.scrollHeight,c={scrollTop:o,scrollLeft:n,offsetWidth:e,offsetHeight:r,scrollWidth:l,scrollHeight:h};return t(c,s(c))}function r(i){var o=i.documentElement,n=o.clientWidth,e=o.clientHeight,r=o.scrollWidth,l=o.scrollHeight,h=i.body.scrollTop||o.scrollTop,c=i.body.scrollLeft||o.scrollLeft,a={scrollTop:h,scrollLeft:c,scrollWidth:r,scrollHeight:l,offsetWidth:n,offsetHeight:e};return t(a,s(a))}function s(t){return{isScrollTopEnd:t.scrollTop<=0,isScrollBottomEnd:t.offsetHeight+t.scrollTop>=t.scrollHeight,isScrollLeftEnd:t.scrollLeft<=0,isScrollRightEnd:t.offsetWidth+t.scrollLeft>=t.scrollWidth}}function l(t){var i="translate("+t.x+"px,"+t.y+"px)";return{transform:i,webkitTransform:i}}function h(t){return"string"==typeof t?document.querySelector(t):t}function c(t,i,o){t.addEventListener(i,o)}function a(t,i,o){t.removeEventListener(i,o)}function u(t){var i=t.touches?t.touches[0]:t;return{x:i.clientX,y:i.clientY}}function f(t,o){return i(t)||n(t)?t:o}function d(t,o){return n(o)?o(t):i(o)?t/o:t}function g(i){this.options=i,this.state=t({},T),this.props=null,this.document=null,this.target=null,this.scroller=null,this.trigger=null,this.isTouching=!1,this.isPreventDefault=!1,this.isWaitForBackToOrigin=!1,this.preventDefault=this.preventDefault.bind(this),this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this)}var p={isScrollTopEnd:!0,isScrollLeftEnd:!0,isScrollBottomEnd:!0,isScrollRightEnd:!0},m={top:"onPullDown",bottom:"onPullUp",left:"onPullRight",right:"onPullLeft"},T={scrollTop:0,scrollLeft:0,scrollWidth:0,scrollHeight:0,offsetWidth:0,offsetHeight:0,isScrollTopEnd:!1,isScrollLeftEnd:!1,isScrollBottomEnd:!1,isScrollRightEnd:!1,startX:0,startY:0,moveX:0,moveY:0,offsetX:0,offsetY:0,translateX:0,translateY:0,direction:"",axis:""},v={target:"body",scroller:"",trigger:"",damping:1.6,top:!1,bottom:!1,left:!1,right:!1,isStatic:!1,drag:!1,detectScroll:!1,fixed:!0,stopPropagation:!0,transitionProperty:"transform",transitionDuration:"0.3s",transitionTimingFunction:"ease-out"},S="function"==typeof Promise;return t(g.prototype,{init:function(){var i=this.options,o=this.document=window.document,n=this.target=h(i.target),e=this.scroller=i.scroller?h(i.scroller):n;this.trigger=i.trigger?h(i.trigger):n,this.isGlobalScroller=e===o.body||e===window||e===o,this.props=t({},v,this.options,{damping:this.getDamping()}),this.enable()},destroy:function(){this.disable(),this.props=null,this.document=null,this.target=null,this.scroller=null,this.trigger=null},getDamping:function(){var t=v.damping,i=this.options.damping,n=null;if(o(i))n={left:f(i.left,t),right:f(i.right,t),top:f(i.top,t),bottom:f(i.bottom,t)};else{var e=f(i,t);n={left:e,right:e,top:e,bottom:e}}return n},setTranslate:function(i,o){var n=l(i),e={transition:"",webkitTransition:""};t(this.target.style,e,n,o)},animateTo:function(i,o,e){n(o)&&(e=o,o=null);var r=this,s=this.props,h=this.target,u=l(i),f={transitionProperty:s.transitionProperty,transitionDuration:s.transitionDuration,transitionTimingFunction:s.transitionTimingFunction,webkitTransitionProperty:s.transitionProperty,webkitTransitionDuration:s.transitionDuration,webkitTransitionTimingFunction:s.transitionTimingFunction},d=function(i){var n=function(t){e&&e(t),i&&i(t),r.handleTransitionEnd(t),a(h,"transitionend",n),a(h,"webkitTransitionEnd",n)};c(h,"transitionend",n),c(h,"webkitTransitionEnd",n),t(h.style,f,u,o)};return S?new Promise(d):void d()},animateToOrigin:function(t,i){n(t)&&(i=t,t=null);var o=this,e=function(t){o.emit("onOrigin",t),i&&i(t),o.clearFixedStyleIfNeed(),o.isWaitForBackToOrigin=!1};return this.animateTo({x:0,y:0},t,e)},enable:function(){c(this.trigger,"touchstart",this.handleTouchStart),c(this.document,"touchmove",this.handleTouchMove),c(this.document,"touchend",this.handleTouchEnd)},disable:function(){a(this.trigger,"touchstart",this.handleTouchStart),a(this.document,"touchmove",this.handleTouchMove),a(this.document,"touchend",this.handleTouchEnd)},preventDefault:function(){this.isPreventDefault=!0},getScrollInfo:function(){var i=null;return i=this.isGlobalScroller?r(this.document):e(this.scroller),this.props.isStatic&&(i=t(i,p)),i},stopPropagationIfNeed:function(t){this.props.stopPropagation&&t.stopPropagation()},detectScrollIfNeed:function(){var t=this.props;if(!t.isStatic&&t.detectScroll){var i=this.state,o=[];if(i.isScrollLeftEnd||!t.left&&!t.onPullRight||o.push("isScrollLeftEnd"),i.isScrollRightEnd||!t.right&&!t.onPullLeft||o.push("isScrollRightEnd"),i.isScrollTopEnd||!t.top&&!t.onPullDown||o.push("isScrollTopEnd"),i.isScrollBottomEnd||!t.bottom&&!t.onPullUp||o.push("isScrollBottomEnd"),o.length)for(var n=this.getScrollInfo(),e=0;e<o.length;e++){var r=o[e];i[r]=n[r]}}},setFixedStyleIfNeed:function(){var i=this.props,o=this.state;!i.isStatic&&i.fixed&&"bottom"===o.direction&&t(this.scroller.style,{height:o.scrollHeight+"px",overflow:"hidden"})},clearFixedStyleIfNeed:function(){var i=this.props,o=this.state;!i.isStatic&&i.fixed&&"bottom"===o.direction&&t(this.scroller.style,{height:"",overflow:""})},emit:function(t,i){var o=this.props[t];if(n(o))return o.call(this,this.state,i)},handleTouchStart:function(i){if(!this.isTouching&&!this.isWaitForBackToOrigin){var o=u(i);this.state=t({},T,this.getScrollInfo(),{startX:o.x,startY:o.y}),this.stopPropagationIfNeed(i),this.isTouching=!0}},handleTouchMove:function(i){if(this.isTouching){var o=u(i),n=this.props,e=this.state,r=e.startX,s=e.startY,l=o.x,h=o.y,c=l-r,a=h-s,f=e.axis,g=e.direction,p=e.isScrollTopEnd,T=e.isScrollBottomEnd,v=e.isScrollLeftEnd,S=e.isScrollRightEnd;this.detectScrollIfNeed(),(!v&&e.isScrollLeftEnd||!S&&e.isScrollRightEnd)&&(c=0,r=l,g=""),(!p&&e.isScrollTopEnd||!T&&e.isScrollBottomEnd)&&(a=0,s=h,g=""),f||(f=Math.abs(a)>=Math.abs(c)?"y":"x"),g||("y"===f?e.isScrollTopEnd&&a>0?g="top":e.isScrollBottomEnd&&a<0&&(g="bottom"):"x"===f&&(e.isScrollLeftEnd&&c>0?g="left":e.isScrollRightEnd&&c<0&&(g="right")));var E=n.damping,b=d(c,E[g]),y=d(a,E[g]);if(t(this.state,{startX:r,startY:s,moveX:l,moveY:h,offsetX:c,offsetY:a,translateX:b,translateY:y,direction:g,axis:f}),g){if(!n.drag){if(!n[m[g]]&&!n[g])return;"y"===f?b=0:"x"===f&&(y=0)}if(this.emit(m[g],i),this.isPreventDefault)return void(this.isPreventDefault=!1);i.preventDefault(),this.isWaitForBackToOrigin=!0,this.setFixedStyleIfNeed(),this.setTranslate({x:b,y:y})}}},handleTouchEnd:function(t){if(this.isTouching){var i=this.state.direction;if(this.isTouching=!1,i)return this.emit(m[i]+"End",t),this.isPreventDefault?void(this.isPreventDefault=!1):void this.animateToOrigin()}},handleTransitionEnd:function(t){this.emit("onTransitionEnd",t)}}),g});
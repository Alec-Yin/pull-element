/*!
 * @license
 * pull-element.js v1.0.0
 * (c) 2017 Jade Gu
 * Released under the MIT License.
 * https://github.com/Lucifier129/pull-element
 */
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.PullElement=i()}(this,function(){"use strict";function t(t){for(var i=arguments,n=i.length,o=1;o<n;o++){var e=i[o];for(var r in e)t[r]=e[r]}return t}function i(t){return"number"==typeof t&&!isNaN(t)}function n(t){return"function"==typeof t}function o(t,i){var n,o,e,r,s=t.scrollWidth,l=t.scrollHeight;if(i){var a=document.documentElement,c=document.body;e=a.clientWidth,r=a.clientHeight,n=c.scrollTop||a.scrollTop,o=c.scrollLeft||a.scrollLeft}else n=t.scrollTop,o=t.scrollLeft,e=t.offsetWidth,r=t.offsetHeight;return{isScrollTopEnd:n<=0,isScrollBottomEnd:r+n>=l,isScrollLeftEnd:o<=0,isScrollRightEnd:e+o>=s}}function e(t){return"string"==typeof t?document.querySelector(t):t}function r(t,i,n){t.addEventListener(i,n)}function s(t,i,n){t.removeEventListener(i,n)}function l(t){var i=t.touches[0];return{x:i.clientX,y:i.clientY}}function a(t,o){return n(o)?o(t):i(o)?t/o:t}function c(t,i){var n="translate("+t+"px,"+i+"px)";return{transform:n,webkitTransform:n}}function u(i){this.options=t({},v,i),this.state=t({},m),this.target=null,this.scroller=null,this.trigger=null,this.transitionStyle=null,this.isTouching=!1,this.isPreventDefault=!1,this.isWaiting=!1,this.isGlobalScroller=!1,this.transitionDuration=0,this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this)}var h={transition:"",transform:"",webkitTransform:"",webkitTransition:""},d={transition:"",webkitTransition:""},f={pullDown:"onPullDown",pullUp:"onPullUp",pullRight:"onPullRight",pullLeft:"onPullLeft"},g={pullDown:"isScrollTopEnd",pullUp:"isScrollBottomEnd",pullRight:"isScrollLeftEnd",pullLeft:"isScrollRightEnd"},p={action:"",axis:"",translateX:0,translateY:0},m=t({isScrollTopEnd:!0,isScrollLeftEnd:!0,isScrollBottomEnd:!0,isScrollRightEnd:!0,clientX:0,clientY:0},p),v={target:"body",scroller:"",trigger:"",damping:1.6,wait:!0,pullUp:!1,pullDown:!1,pullLeft:!1,pullRight:!1,detectScroll:!1,detectScrollOnStart:!1,detectScrollOnMove:!1,stopPropagation:!1,drag:!1,transitionProperty:"transform",transitionDuration:"0.3s",transitionTimingFunction:"ease-out"},T="function"==typeof Promise;return t(u.prototype,{init:function(){var t=this.options,i=e(t.target),n=t.scroller?e(t.scroller):i,o=t.trigger?e(t.trigger):i;this.target=i,this.scroller=n,this.trigger=o,this.isGlobalScroller=n===document.body||n===window||n===document.documentElement,this.transitionStyle={transitionProperty:t.transitionProperty,transitionDuration:t.transitionDuration,transitionTimingFunction:t.transitionTimingFunction,webkitTransitionProperty:t.transitionProperty,webkitTransitionDuration:t.transitionDuration,webkitTransitionTimingFunction:t.transitionTimingFunction};var r=Number(t.transitionDuration.replace(/[^.\d]+/g,""));/[\d\.]+s$/.test(t.transitionDuration)&&(r*=1e3),this.transitionDuration=r,this.enable()},destroy:function(){this.disable()},setTranslate:function(i,n){t(this.target.style,d,c(i,n))},animateTo:function(i,n,o){var e=this.state,r=this.target,s=this.transitionDuration,l=this.transitionStyle,a=c(i,n);e.translateX=i,e.translateY=n;var u=function(i){t(r.style,l,a),setTimeout(i,s)};return T?new Promise(u).then(o):void u(o)},animateToOrigin:function(i){this.isWaiting=!0;var n=this,o=function(){t(n.target.style,h),t(n.state,p),n.isWaiting=!1,i&&i()};return this.animateTo(0,0,o)},enable:function(){r(this.trigger,"touchstart",this.handleTouchStart),r(document,"touchmove",this.handleTouchMove),r(document,"touchend",this.handleTouchEnd)},disable:function(){s(this.trigger,"touchstart",this.handleTouchStart),s(document,"touchmove",this.handleTouchMove),s(document,"touchend",this.handleTouchEnd)},preventDefault:function(){this.isPreventDefault=!0},getScrollInfo:function(){return o(this.scroller,this.isGlobalScroller)},isActiveAction:function(t){var i=this.options,n=f[t];return i[n]||i[n+"End"]||i[t]},emit:function(t){var i=this.options[t];if(n(i)){var o=this.state,e={translateX:o.translateX,translateY:o.translateY};i.call(this,e)}},handleTouchStart:function(i){if(!this.isTouching&&!this.isWaiting){var n=this.options,o=l(i);t(this.state,{clientX:o.x,clientY:o.y,axis:"",action:""}),(n.detectScroll||n.detectScrollOnStart)&&t(this.state,this.getScrollInfo()),n.stopPropagation&&i.stopPropagation(),this.isTouching=!0}},handleTouchMove:function(i){if(this.isTouching){var n=l(i),o=this.options,e=this.state,r=n.x,s=n.y,c=r-e.clientX,u=s-e.clientY,h=e.translateX,d=e.translateY,p=e.axis,m=e.action;p||(p=Math.abs(u)>=Math.abs(c)?"y":"x"),m||("y"===p?u>0?m="pullDown":u<0&&(m="pullUp"):"x"===p&&(c>0?m="pullRight":c<0&&(m="pullLeft")));var v=this.isActiveAction(m);v&&(o.detectScroll||o.detectScrollOnMove)&&!e[g[m]]&&t(e,this.getScrollInfo());var T=v&&e[g[m]];if(T&&(h+=a(c,o.damping),d+=a(u,o.damping)),t(e,{clientX:r,clientY:s,translateX:h,translateY:d,action:m,axis:p}),T){if(o.drag||("y"===p?h=0:"x"===p&&(d=0)),this.emit(f[m]),this.isPreventDefault)return void(this.isPreventDefault=!1);o.wait&&(this.isWaiting=!0),i.preventDefault(),this.setTranslate(h,d)}}},handleTouchEnd:function(){if(this.isTouching){this.isTouching=!1;var t=this.state,i=t.action;if(this.isActiveAction(i)&&t[g[i]])return this.emit(f[i]+"End"),this.isPreventDefault?void(this.isPreventDefault=!1):void this.animateToOrigin()}}}),u});